!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory(exports,require("@angular/platform-browser-dynamic"),require("@angular/core"),require("lodash"),require("@angular/platform-browser"),require("@angular/common"),require("@angular/router"),require("rxjs/operator/pluck")):"function"==typeof define&&define.amd?define(["exports","@angular/platform-browser-dynamic","@angular/core","lodash","@angular/platform-browser","@angular/common","@angular/router","rxjs/operator/pluck"],factory):factory((global.synapse=global.synapse||{},global.synapse.componentLab=global.synapse.componentLab||{}),global.ng.platformBrowserDynamic,global.ng.core,global._,global.ng.platformBrowser,global.ng.common,global.ng.router,global.Rx.Observable.prototype)}(this,function(exports,_angular_platformBrowserDynamic,_angular_core,lodash,_angular_platformBrowser,_angular_common,_angular_router,rxjs_operator_pluck){"use strict";function byId(entities,next){return void 0===entities&&(entities={}),Object.assign(entities,(_a={},_a[next.id]=next,_a));var _a}function provideExperiments(experiments){return{provide:EXPERIMENTS,useValue:experiments}}function provideResolvedLab(lab){return{provide:RESOLVED_LAB,useValue:lab}}function getModuleForExperiments(inputModule,experiments){var componentsWithIds=lodash.flatten(experiments.map(function(exp){return exp.cases.map(function(c){return{id:c.id,component:generateComponent(c)}})})),components=componentsWithIds.reduce(function(all,next){return Object.assign(all,(_a={},_a[next.id]=next.component,_a));var _a},{}),ngModule=generateNgModule(inputModule,componentsWithIds.map(function(e){return e.component}));return{ngModule:ngModule,components:components}}function generateComponent(experimentCase){var ExperimentCaseComponent=function(){function ExperimentCaseComponent(){Object.assign(this,experimentCase.context||{})}return ExperimentCaseComponent=__decorate$2([_angular_core.Component({template:experimentCase.template,styles:experimentCase.styles}),__metadata$2("design:paramtypes",[])],ExperimentCaseComponent)}();return ExperimentCaseComponent}function generateNgModule(inputModule,components){var ExperimentModule=function(){function ExperimentModule(){}return ExperimentModule=__decorate$2([_angular_core.NgModule({imports:[inputModule],declarations:[components],entryComponents:[components]}),__metadata$2("design:paramtypes",[])],ExperimentModule)}();return ExperimentModule}function bootstrap(lab){var experiments=lab.loadExperiments(),resolved=getModuleForExperiments(lab.ngModule,experiments),platform=_angular_platformBrowserDynamic.platformBrowserDynamic([provideExperiments(experiments),provideResolvedLab(resolved)]);return platform.bootstrapModule(ComponentLabModule)}function createLab(lab){bootstrap(lab)}function experimentOn(component,module){return new ExperimentBuilder(component,module)}var __decorate=void 0||function(decorators,target,key,desc){var d,c=arguments.length,r=3>c?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(3>c?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata=void 0||function(k,v){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(k,v):void 0},__param=void 0||function(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}},EXPERIMENTS=new _angular_core.OpaqueToken("Experiments"),ExperimentRegistryService=function(){function ExperimentRegistryService(experiments){this.experiments={},this.experimentCases={},this.experiments=experiments.reduce(byId,{}),this.experimentCases=experiments.reduce(function(all,next){return Object.assign(all,next.cases.reduce(byId,{}))},{})}return ExperimentRegistryService.prototype.getExperiment=function(id){return this.experiments[id]},ExperimentRegistryService.prototype.getExperimentCase=function(id){return this.experimentCases[id]},ExperimentRegistryService.prototype.getAllExperiments=function(){var _this=this;return Object.keys(this.experiments).map(function(key){return _this.experiments[key]})},ExperimentRegistryService=__decorate([_angular_core.Injectable(),__param(0,_angular_core.Inject(EXPERIMENTS)),__metadata("design:paramtypes",[Array])],ExperimentRegistryService)}(),__decorate$1=void 0||function(decorators,target,key,desc){var d,c=arguments.length,r=3>c?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(3>c?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata$1=void 0||function(k,v){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(k,v):void 0},__param$1=void 0||function(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}},RESOLVED_LAB=new _angular_core.OpaqueToken("Resolved Lab"),ExperimentFactoryService=function(){function ExperimentFactoryService(lab,compiler){this._lab=lab,this._factory=compiler.compileModuleSync(lab.ngModule)}return ExperimentFactoryService.prototype.compileComponent=function(id,injector){var component=this._lab.components[id],ref=this._factory.create(injector),factory=ref.componentFactoryResolver.resolveComponentFactory(component);return{factory:factory,injector:ref.injector}},ExperimentFactoryService=__decorate$1([_angular_core.Injectable(),__param$1(0,_angular_core.Inject(RESOLVED_LAB)),__metadata$1("design:paramtypes",[Object,_angular_core.Compiler])],ExperimentFactoryService)}(),__decorate$2=void 0||function(decorators,target,key,desc){var d,c=arguments.length,r=3>c?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(3>c?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata$2=void 0||function(k,v){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(k,v):void 0},__decorate$4=void 0||function(decorators,target,key,desc){var d,c=arguments.length,r=3>c?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(3>c?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata$4=void 0||function(k,v){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(k,v):void 0},RootContainerComponent=function(){function RootContainerComponent(registry){this.experiments=registry.getAllExperiments()}return RootContainerComponent=__decorate$4([_angular_core.Component({selector:"cl-root-container",template:'\n    <cl-layout>\n      <cl-nav [experiments]="experiments"></cl-nav>\n\n      <div class="grow">\n        <router-outlet></router-outlet>\n      </div>\n    </cl-layout>\n  ',styles:["\n    .grow {\n      flex-grow: 5;\n    }\n  "]}),__metadata$4("design:paramtypes",[ExperimentRegistryService])],RootContainerComponent)}(),__decorate$5=void 0||function(decorators,target,key,desc){var d,c=arguments.length,r=3>c?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(3>c?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata$5=void 0||function(k,v){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(k,v):void 0},PreviewContainerComponent=function(){function PreviewContainerComponent(route){this.caseID$=rxjs_operator_pluck.pluck.call(route.params,"caseID")}return PreviewContainerComponent=__decorate$5([_angular_core.Component({selector:"cl-preview-container",template:'\n    <cl-stage>\n      \n      <cl-renderer [id]="caseID$ | async"></cl-renderer>\n    </cl-stage>\n  ',styles:["\n    :host {\n      display: flex;\n      flex-direction: column;\n      width: 100%;\n      height: 100%;\n    }\n  "]}),__metadata$5("design:paramtypes",[_angular_router.ActivatedRoute])],PreviewContainerComponent)}(),routes=[{path:"",redirectTo:"/experiment",pathMatch:"full"},{path:"experiment",component:RootContainerComponent,children:[{path:"preview/:experimentID/:caseID",component:PreviewContainerComponent}]}],Routing=_angular_router.RouterModule.forRoot(routes),__decorate$6=void 0||function(decorators,target,key,desc){var d,c=arguments.length,r=3>c?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(3>c?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata$6=void 0||function(k,v){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(k,v):void 0},ComponentLabComponent=function(){function ComponentLabComponent(){}return ComponentLabComponent=__decorate$6([_angular_core.Component({selector:"component-lab",encapsulation:_angular_core.ViewEncapsulation.None,template:"\n    <router-outlet></router-outlet>\n  "}),__metadata$6("design:paramtypes",[])],ComponentLabComponent)}(),__decorate$7=void 0||function(decorators,target,key,desc){var d,c=arguments.length,r=3>c?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(3>c?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata$7=void 0||function(k,v){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(k,v):void 0},RendererComponent=function(){function RendererComponent(experimentFactory,injector,view){this.experimentFactory=experimentFactory,this.injector=injector,this.view=view}return RendererComponent.prototype._cleanup=function(){this._ref&&(this._ref.destroy(),this._ref=null)},Object.defineProperty(RendererComponent.prototype,"id",{set:function(id){this._cleanup();var _a=this.experimentFactory.compileComponent(id,this.injector),factory=_a.factory,injector=_a.injector,position=this.view.length;this._ref=this.view.createComponent(factory,position,injector,[])},enumerable:!0,configurable:!0}),RendererComponent.prototype.ngOnDestroy=function(){this._cleanup()},__decorate$7([_angular_core.Input(),__metadata$7("design:type",String),__metadata$7("design:paramtypes",[String])],RendererComponent.prototype,"id",null),RendererComponent=__decorate$7([_angular_core.Component({selector:"cl-renderer",template:""}),__metadata$7("design:paramtypes",[ExperimentFactoryService,_angular_core.Injector,_angular_core.ViewContainerRef])],RendererComponent)}(),__decorate$8=void 0||function(decorators,target,key,desc){var d,c=arguments.length,r=3>c?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(3>c?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata$8=void 0||function(k,v){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(k,v):void 0},NavComponent=function(){function NavComponent(){}return __decorate$8([_angular_core.Input(),__metadata$8("design:type",Array)],NavComponent.prototype,"experiments",void 0),__decorate$8([_angular_core.Input(),__metadata$8("design:type",Object)],NavComponent.prototype,"activeCase",void 0),NavComponent=__decorate$8([_angular_core.Component({selector:"cl-nav",template:'\n    <nav>\n      <div *ngFor="let experiment of experiments" class="experiment">\n        <span class="experimentName">\n          {{ experiment.name }}\n        </span>\n\n        <nav class="cases">\n          <a \n            *ngFor="let c of experiment.cases" \n            [routerLink]="[ \'/\', \'experiment\', \'preview\', experiment.id, c.id ]"\n            routerLinkActive="caseLinkActive"\n            class="caseLink">\n            {{ c.description }}\n          </a>\n        </nav>\n      </div>\n    </nav>\n  ',styles:["\n    :host {\n      display: block;\n      padding: 16px;\n      width: 220px;\n      max-height: 100vh;\n      overflow: auto;\n      box-sizing: border-box;\n    }\n\n    span, a {\n      font-family: 'Open Sans', sans-serif;\n      color: #EEEFF7;\n    }\n\n    .experiment:not(:last-child) {\n      padding-bottom: 10px;\n      margin-bottom: 20px;\n      border-bottom: 2px solid #232730;\n    }\n\n    .experimentName {\n      display: block;\n      font-size: 13px;\n      margin: 12px 0 8px;\n      padding: 0px 8px;\n    }\n\n    .caseLink {\n      font-size: 11px;\n      color: #626D79;\n      display: block;\n      text-decoration: none;\n      margin: 10px 0px;\n      padding: 8px;\n      margin: 4px 0px;\n      transition: all 200ms;\n    }\n\n    .caseLink.caseLinkActive, .caseLink:hover {\n      color: white;\n      background-color: #1D202B;\n    }\n  "]}),__metadata$8("design:paramtypes",[])],NavComponent)}(),__decorate$9=void 0||function(decorators,target,key,desc){var d,c=arguments.length,r=3>c?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(3>c?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata$9=void 0||function(k,v){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(k,v):void 0},LayoutComponent=function(){function LayoutComponent(){}return LayoutComponent=__decorate$9([_angular_core.Component({selector:"cl-layout",template:"\n    <ng-content></ng-content>\n  ",styles:["\n    :host {\n      display: flex;\n      flex-direction: row;\n      min-width: 100vw;\n      min-height: 100vh;\n      background-color: #262A34;\n      box-sizing: border-box;\n    }\n  "]}),__metadata$9("design:paramtypes",[])],LayoutComponent)}(),__decorate$10=void 0||function(decorators,target,key,desc){var d,c=arguments.length,r=3>c?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(3>c?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata$10=void 0||function(k,v){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(k,v):void 0},StageComponent=function(){function StageComponent(){}return StageComponent=__decorate$10([_angular_core.Component({selector:"cl-stage",template:"\n    <ng-content></ng-content>\n  ",styles:["\n    :host {\n      display: block;\n      background-color: white;\n      height: 100%;\n      box-sizing: border-box;\n      padding: 20px;\n    }\n  "]}),__metadata$10("design:paramtypes",[])],StageComponent)}(),__decorate$11=void 0||function(decorators,target,key,desc){var d,c=arguments.length,r=3>c?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(3>c?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata$11=void 0||function(k,v){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(k,v):void 0},ToolbarComponent=function(){function ToolbarComponent(){}return ToolbarComponent=__decorate$11([_angular_core.Component({selector:"cl-toolbar",template:'\n    <div class="button-group">\n      <button>\n        <i class="material-icons md-18">desktop_windows</i>\n      </button>\n      <button>\n        <i class="material-icons md-18">tablet_android</i>\n      </button>\n      <button>\n        <i class="material-icons md-18">phone_iphone</i>\n      </button>\n    </div>\n\n    <!--\n    <i class="material-icons">brightness_1</i>\n    <i class="material-icons">brightness_5</i>\n    -->\n  ',styles:["\n    :host {\n      display: block;\n      width: 100%;\n      height: 40px;\n      padding: 4px;\n      background-color: #F4F7FA;\n    }\n\n    .button-group {\n      width: 100%;\n      display: flex;\n      flex-direction: row;\n\n    }\n\n    button {\n      display: block;\n      width: 32px;\n      height: 32px;\n      margin: 0 4px;\n      background-color: transparent;\n      outline: none !important;\n      box-shadow: none !important;\n      border: none !important;\n      opacity: 0.1;\n      transition: opacity 250ms;\n      cursor: pointer;\n    }\n\n    button.selected, button:hover {\n      opacity: 0.5;\n    }\n  "]}),__metadata$11("design:paramtypes",[])],ToolbarComponent)}(),__decorate$3=void 0||function(decorators,target,key,desc){var d,c=arguments.length,r=3>c?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(3>c?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata$3=void 0||function(k,v){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(k,v):void 0},ComponentLabModule=function(){function ComponentLabModule(){}return ComponentLabModule=__decorate$3([_angular_core.NgModule({imports:[_angular_platformBrowser.BrowserModule,_angular_common.CommonModule,Routing],providers:[ExperimentFactoryService,ExperimentRegistryService],declarations:[ComponentLabComponent,RendererComponent,RootContainerComponent,NavComponent,PreviewContainerComponent,LayoutComponent,StageComponent,ToolbarComponent],entryComponents:[RootContainerComponent,PreviewContainerComponent],bootstrap:[ComponentLabComponent]}),__metadata$3("design:paramtypes",[])],ComponentLabModule)}(),ExperimentBuilder=function(){function ExperimentBuilder(name,module){this.name=name,this.module=module,this.cases=[],this._callCount=0,this.id="exp"+(module?module.id:"")}return ExperimentBuilder.prototype.case=function(description,config){return this.cases.push({id:this.id+"-"+ ++this._callCount,description:description,template:config.template,context:config.context,styles:config.styles}),this},ExperimentBuilder.prototype.xcase=function(){return this},ExperimentBuilder}();exports.createLab=createLab,exports.ExperimentBuilder=ExperimentBuilder,exports.experimentOn=experimentOn,Object.defineProperty(exports,"__esModule",{value:!0})});